var operators;(()=>{"use strict";var e={d:(t,a)=>{for(var s in a)e.o(a,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:a[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function a(e,t,a,v){let d=null,b=null,m=new Map;for(let T=0;T<t.length;T++)if(b=t[T],d=null,"op"in b){for(let t=0;t<b.args.length;t++)b.args[t]=o(b.args[t],v,m,e);switch(b.op){case"at":d=r(b.args[0],b.args[1],v.strings);break;case"of":d=i(b.args[0],b.args[1],v.strings);break;case"+":h=b.args[0],I=b.args[1],d={name:"add_res",val:c(h.val)+c(I.val),start_pos:h.start_pos,end_pos:h.end_pos};break;case"-":d=g(b.args[0],b.args[1]);break;case"and":d=p(b.args[0],b.args[1]);break;case"or":d=_(b.args[0],b.args[1]);break;case"not":d={name:"or_res",val:!f((k=b.args[0]).val),start_pos:k.start_pos,end_pos:k.end_pos};break;case"uint8":case"uint8be":d=u(b.args[1],e,1);break;case"uint16":d=u(b.args[1],e,2);break;case"uint32":d=u(b.args[1],e,4);break;case"uint16be":d=u(b.args[1],e,2,!1,!1);break;case"uint32be":d=u(b.args[1],e,4,!1,!1);break;case"int8":case"int8be":d=u(b.args[1],e,1,!0);break;case"int16":d=u(b.args[1],e,2,!0);break;case"int32":d=u(b.args[1],e,4,!0);break;case"int16be":d=u(b.args[1],e,2,!0,!1);break;case"int32be":d=u(b.args[1],e,4,!0,!1);break;case"identifier":d=l(b.args[0],a);break;case"STRING_IDENTIFIER":d=b.args[0];break;case"<":case"<=":case">":case">=":case"==":case"!=":d=n(b.op,b.args[0],b.args[1]);break;case"in":d=s(b.args[0],b.args[1],v.strings);break;case"..":d={name:"range",val:[c(b.args[0].val),c(b.args[1].val)],start_pos:b.args[0].start_pos,end_pos:b.args[1].end_pos};break;default:console.log(`"${b.op}" is not supported yet`),d={name:`${b.op}_unsupported`,val:!1,start_pos:b.args[0].start_pos,end_pos:b.args[b.args.length-1].end_pos}}null!==d&&(m.set(b.id,d),b.result=d)}var k,h,I;v.condition=t}function s(e,t,a){let s=a.get(e.val_str.slice(1)),r=!1;for(let e=0;e<s.length;e++)if(s[e].start>=t.val[0]&&s[e].end<=t.val[1]){r=!0;break}return{name:"in_res",val:r,start_pos:e.start_pos,end_pos:t.end_pos}}function r(e,t,a){let s=a.get(e.val_str.slice(1)),r=!1;for(let e=0;e<s.length;e++)if(s[e].start==parseInt(t.val)){r=!0;break}return{name:"at_res",val:r,start_pos:e.start_pos,end_pos:t.end_pos}}function n(e,t,a){let s="NUMBER"==t.name?c(t.val):parseInt(t.val),r="NUMBER"==a.name?c(a.val):parseInt(a.val);return{name:"logical_comp_res",val:{"<":function(e,t){return e<t},"<=":function(e,t){return e<=t},">":function(e,t){return e>t},">=":function(e,t){return e>=t},"==":function(e,t){return e==t},"!=":function(e,t){return e!=t}}[e](s,r),start_pos:t.start_pos,end_pos:a.end_pos}}function o(e,t,a,s){if("Task"===e.name)return a.get(e.val);if("STRING_IDENTIFIER"==e.name){let a=e.val.slice(1);return e.val_str=e.val,e.val=t.strings.get(a).length>=1,e}if("STRING_COUNT"==e.name){let a=e.val.slice(1);return e.val=t.strings.get(a).length,e}if("STRING_LENGTH"==e.name){let a=e.val.slice(1),s=t.strings.get(a);return e.val=s.length>0?s[0].end-s[0].start+1:-1,e}if("STRING_OFFSET"==e.name){let a=e.val.slice(1),s=t.strings.get(a);return e.val=s.length>0?s[0].start:-1,e}return"FILESIZE"===e.name?(e.val=s.length,e):e}function l(e,t){let a=!1;return t.has(e.val)&&(a=t.get(e.val).condition[t.get(e.val).condition.length-1].result.val),{name:"identifier_res",val:a,start_pos:e.start_pos,end_pos:e.end_pos}}function i(e,t,a){let s=[];if("THEM"===t.name)for(let e of a.keys())s.push(e);else if("STRING_IDENTIFIER_WITH_WILDCARD"===t.name){let e=(r=t.val,r.length>1&&("$"===r[0]||"#"===r[0]||"@"===r[0])?r.slice(1):r).slice(0,-1);for(let t of a.keys())t.startsWith(e)&&s.push(t)}var r;let n=0;n="ALL"===e.name?s.length:"ANY"===e.name?1:c(e.val);let o=!1;if(n>0){for(let e=0;e<s.length;e++)if(a.get(s[e]).length>0&&(n-=1,0===n)){o=!0;break}}else o=!0;return{name:"of_res",val:o,start_pos:e.start_pos,end_pos:e.end_pos}}function g(e,t){return{name:"minus_res",val:c(e.val)-c(t.val),start_pos:e.start_pos,end_pos:e.end_pos}}function p(e,t){return{name:"and_res",val:f(e.val)&&f(t.val),start_pos:e.start_pos,end_pos:e.end_pos}}function _(e,t){return{name:"or_res",val:f(e.val)||f(t.val),start_pos:e.start_pos,end_pos:e.end_pos}}function u(e,t,a,s=!1,r=!0){let n=NaN,o=parseInt(e.val);if(o+a<t.buffer.byteLength){let e=new DataView(t.buffer,o,a);switch(a){case 1:o<t.length&&(n=s?e.getInt8(0):e.getUint8(0));break;case 2:o<t.length-1&&(n=s?e.getInt16(0,r):e.getUint16(0,r));break;case 4:o<t.length-3&&(n=s?e.getInt32(0,r):e.getUint32(0,r))}}return{name:`${s?"":"u"}int${8*a}${r?"":"be"}_res`,val:n,start_pos:e.start_pos,end_pos:e.end_pos}}function c(e){if("number"==typeof e)return e;let t=0;return e.startsWith("0x")?t=parseInt(e,16):(t=parseInt(e),e.endsWith("KB")?t*=1e3:e.endsWith("MB")&&(t*=1e6)),t}function f(e){return"boolean"==typeof e?e:function(e){let t=!1;return"true"===e&&(t=!0),t}(e)}e.r(t),e.d(t,{eval_condition:()=>a}),operators=t})();