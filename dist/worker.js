var worker;(()=>{if("function"==typeof importScripts){function e(e,t){let r=0,l=[],s=null,o=function(e){let t=[],r=e,n=!1,l=!1,s=null;for(let e=0;e<r.length;e++){if(s=r[e].split(/[ ,]/),"chr"==s[0])n=s[1].startsWith("?")?0:15,l=s[1].endsWith("?")?0:240,s[1]=parseInt(s[1].replace("?","0"),16),s.push(l|n);else if("chrc"==s[0])for(let e=1;e<s.length;e++)s[e]=parseInt(s[e],16);else"jmp"==s[0]?s[1]=i(e,s[1]):s[0].startsWith("split")?(s[1]=i(e,s[1]),s[2]=i(e,s[2])):"ignore"==s[0]&&(s[1]=parseInt(s[1]),s[2]=parseInt(s[2]));t.push(s)}return t}(t);"chr"==o[0][0]&&o[0][1];let a=[];for(let e=0;e<10;e++)a.push({pc:0,priority:0});let p=performance.now();for(;r<e.length&&(s=n(e,o,r,a),null!=s);)r=s.start+1,l.push(s);return(performance.now()-p).toString(),l}function t(e,t,r){let n=null;return 0!=e.length?(n=e.pop(),n.pc=t,n.priority=r):n={pc:t,priority:r},n}function r(e,t){e.push(...t),t.length=0}function n(e,n,i,s){let o=[];o.push(t(s,0,0));let a=[],p=0,c=null,h=null,u=!1,f=null,g=[],d=null,y=!1;for(let m=i;m<e.length;m++){y=!1;for(let r=0;r<o.length&0==y;r++)switch(p=o[r].pc,h=n[p],c=h[0],c){case"chr":if(u=0==h[2]||h[1]==(e[m]&h[2]),!1===u){if(0==g.length)break;d=g.pop(),m=d.end,p=d.ignore_loc,d.end-=1,d.start<=d.end&&g.push(d)}l(a,t(s,p+1,o[r].priority));break;case"chrc":let n=1+(e[m]>>3),c=1<<(7&e[m]);if(u=0!=(h[n]&c),!1===u){if(0==g.length)break;d=g.pop(),m=d.end,p=d.ignore_loc,d.end-=1,d.start<=d.end&&g.push(d)}a.push(t(s,p+1,o[r].priority));break;case"ignore":-1==h[2]&&(h[2]=e.length),g.push({start:m+h[1]-1,end:m+h[2]-1,ignore_loc:p}),m=m+h[1]-1,l(a,t(s,p+1,o[r].priority));break;case"splitjmp":l(o,t(s,h[1],o[r].priority)),l(o,t(s,h[2],o[r].priority+1));break;case"splitstay":case"split":l(o,t(s,h[1],o[r].priority+1)),l(o,t(s,h[2],o[r].priority));break;case"jmp":l(o,t(s,h[1],o[r].priority));break;case"match":(null==f||f.end<m-1)&&(f={start:i,end:m-1,match:!0}),y=!0}if(0==a.length){if(null!=f)return f;r(s,o),i=m+1,o.push(t(s,0,0))}else r(s,o),o=a,a=[]}return f}function l(e,t){e.push(t);let r=e.length-1;for(let t=e.length-2;t>=0&&e[r].priority<e[t].priority;t--){let n=e[r];e[r]=e[t],e[t]=n,r=t}}function i(e,t){let r=t;return t.startsWith("[")?(r=t.substr(1,t.length-2),r=parseInt(r)+e):r=parseInt(r),r}self.importScripts("operators.js"),self.onmessage=function(t){let r=t.data,n=function(t,r){let n={strings:new Map,condition:[]};return Object.keys(r).forEach((function(l){"string"==l?function(t,r,n){let l=null;for(let e=0;e<t.length;e++)n.set(t[e].str_name.slice(1),[]);for(const i in t){let s=t[i];if("hex_exp_bytecode"==s.type||"regex_expression_bytecode"==s.type){if(l=e(r,s.val),null!=l)for(let e=0;e<l.length;e++)n.get(s.str_name.slice(1)).push({string:s,start:l[e].start,end:l[e].end})}else if("literal_string"==s.type){let t=!1,i=!1,o=!1;for(let e=0;e<s.modifiers.length;e++)switch(s.modifiers[e].modifier){case"nocase":t=!0;break;case"ascii":i=!0;break;case"wide":o=!0}0==o&&(i=!0);let a=[];s.val=s.val.substr(1,s.val.length-2);for(let e=0;e<s.val.length;e++)a.push(`chr ${s.val.charCodeAt(e).toString(16)}`);if(a.push("match"),l=e(r,a),null!=l)for(let e=0;e<l.length;e++)n.get(s.str_name.slice(1)).push({string:s,start:l[e].start,end:l[e].end})}}}(r[l],t,n.strings):"condition"==l&&operators.eval_condition(t,r[l],n)})),n}(r.file,r.rule);n.rule_name=r.rule_name,n.hex_editor_id=r.hex_editor_id,self.postMessage(n)}}worker={}})();